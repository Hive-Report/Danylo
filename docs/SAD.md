# Software Architecture Documentation

**Проєкт**: uspacy-data-feeder  
**Версія документа**: 0.1  
**Дата**: 04.08.2025  
**Автор**: [Олександр Бажин / команда]

---

## 1. Огляд системи

`uspacy-data-feeder` — сервіс для автоматичного збору, перевірки та оновлення інформації про КЕП (кваліфіковані електронні підписи) компаній в системі CRM Uspacy.

Мета — забезпечити актуальність даних по КЕП, автоматизувати додавання нових записів, спростити контроль за діючими сертифікатами та забезпечити розробникам можливість ручного втручання у виняткових випадках.

---

## 2. Функціональні вимоги

| №  | Вимога                                      | Опис |
|----|---------------------------------------------|------|
| F1 | Збір даних по всім компаніям                | Автоматичне отримання інформації по КЕП для всіх компаній в CRM через зовнішній API. |
| F2 | Визначення нових клієнтів                   | Нові клієнти — це компанії, у яких немає жодного діючого КЕП. |
| F3 | Вебхук для нових компаній                   | Якщо в Uspacy додається нова компанія — автоматично шукати КЕП через зовнішній API. |
| F4 | Ручне додавання                             | Розробник має можливість вручну додати КЕП для конкретної компанії через адмін-інтерфейс або CLI. |
| F5 | Періодичне оновлення КЕП                    | Запуск оновлення даних для компаній з КЕП, які наближаються до закінчення. |
| F6 | Видалення неактуальних КЕП                 | Якщо сертифікат прострочено або має статус "Скасований", він видаляється з CRM. |
| F7 | Повне оновлення по всім компаніям          | Можливість запускати періодичне оновлення даних по всім компаніям незалежно від стану. |
| F8 | Перевірка дублювання                        | Якщо в Uspacy вже є аналогічний КЕП, не оновлювати його повторно. |
| F9 | Створення нових КЕП замість оновлення       | Стара інформація видаляється, нова створюється як новий об’єкт. |
| F10| Резервне джерело інформації                 | Якщо основний API недоступний — використовувати альтернативне джерело. |
| F11| Майбутнє розширення                         | Підтримка інших типів даних (не лише КЕП). |

---

## 3. Нефункціональні вимоги

| №   | Вимога             | Опис |
|-----|--------------------|------|
| NF1 | Надійність         | Сервіс має гарантувати повну обробку всіх даних — недообробка недопустима. |
| NF2 | Швидкодія          | Оновлення має проходити у визначений період часу без суттєвих затримок. |
| NF3 | Валідація          | Перед оновленням чи створенням КЕП дані проходять сувору валідацію. |
| NF4 | Масштабованість    | Архітектура має дозволяти масштабування в разі збільшення кількості компаній або джерел даних. |
| NF5 | Тестованість       | Увесь код має бути покритий unit та інтеграційними тестами. |
| NF6 | Спостережуваність  | Сервіс має мати логування, метрики обробки та алерти у разі помилок. |
| NF7 | Інтероперабельність| Взаємодія з CRM Uspacy через webhook, REST API або інші засоби. |
| NF8 | Безпека            | Доступ до API та CRM — тільки через захищені канали з авторизацією. |

---

## 4. Архітектура системи (огляд)

![System Architecture Diagram](pictures/System%20Architecture%20diagram.png)